{{- $dashboardFiles := .Files.Glob "dashboards/*.json" }}
{{- if $dashboardFiles }}
{{- range $path, $fileContents := $dashboardFiles }}
{{- $dashboardName := base $path }}
---
apiVersion: v1
kind: ConfigMap
metadata:
  name: grafana-dashboard-{{ $dashboardName | replace "." "-" | lower }}
  labels:
    grafana_dashboard: "1"
data:
  {{ $dashboardName }}: |
{{ $.Files.Get $path | indent 4 }}
{{- end }}
{{- end }}